## Objective:
The objective of this task was to develop, implement, and evaluate an Artificial Neural Network (ANN) model to predict customer churn. The process involved defining the model architecture, training the model, saving relevant results, and tallying the predictions with actual test data for validation. The ultimate goal was to create a reliable model that could accurately predict customer churn, providing actionable insights.

## Steps Taken:

### 1. Setting Up the Configuration:
   - **Objective**: Ensure that all file paths, directories, and configurations were centrally managed using a `config.json` file located in the root directory.
   - **Explanation**:
     - The `config.json` file contains paths to datasets, models, and results.
     - Paths were dynamically loaded in the `predictive_modeling.py` and `PredictionTally.py` scripts to ensure consistency and flexibility.

### 2. Loading the Configuration:
   - **Objective**: Load the configuration file to obtain paths and settings needed for the predictive modeling and tally tasks.
   - **Explanation**:
     - In both `predictive_modeling.py` and `PredictionTally.py`, the configuration file was loaded using Python's `json` module.
     - The `os` module was used to construct absolute paths based on the project's root directory.

### 3. Defining and Training the ANN Model:
   - **Objective**: Design and train an ANN model using the train and test datasets.
   - **Explanation**:
     - The ANN model was defined using TensorFlow's Keras API with layers appropriate for binary classification (customer churn).
     - The model was trained using the provided training dataset and validated against the test dataset to ensure generalization.

### 4. Saving Model and Results:
   - **Objective**: Save the trained model, model architecture, and training results for future reference and use.
   - **Explanation**:
     - The best model during training was saved using `ModelCheckpoint`.
     - The model architecture was saved in a JSON format.
     - The training history (e.g., accuracy and loss per epoch) was saved in a text file.
     - Predictions were generated and saved in a CSV file for further analysis.

### 5. Running the Prediction Tally:
   - **Objective**: Tally the predictions generated by the ANN model with the actual values from the test dataset.
   - **Explanation**:
     - The `PredictionTally.py` script was used to compare the predicted results with the actual labels in the test dataset.
     - The tally results, including any mismatches, were saved in a CSV file for analysis.

### 6. Integration with Utility Functions:
   - **Objective**: Modularize the code by moving the tally functionality to a utility function for better organization and reusability.
   - **Explanation**:
     - The `run_prediction_tally` function was moved to `PredictionTally.py` under the `utils` directory.
     - This function was imported and executed within `predictive_modeling.py`, ensuring that predictions were tallied every time the model was run.

### 7. Optimizing Model Convergence (CCA11):
   - **Objective**: Train the model and optimize it to ensure convergence while preventing overfitting.
   - **Explanation**:
     - The model was trained with a focus on optimizing convergence using techniques such as dropout and early stopping.
     - The `EarlyStopping` callback was employed to monitor the validation loss, ensuring the model did not overfit by stopping the training once the validation loss plateaued.
     - A final model was saved, reflecting the best performance during training.
   
### 8. Predicting Customer Churn:
   - **Objective**: Utilize the trained model to predict customer churn on the test dataset.
   - **Explanation**:
     - The trained ANN model was used to predict the likelihood of churn for each customer in the test dataset.
     - The predictions were saved to a CSV file (`predictions.csv`) for further analysis.

### 9. Evaluating Model Performance and Analyzing Predictions:
   - **Objective**: Evaluate the performance of the trained model and analyze the accuracy of the predictions made.
   - **Explanation**:
     - The accuracy, loss, and other relevant metrics were calculated for both the training and validation datasets.
     - The results were compared to ensure the model's generalization capability, and any potential overfitting was assessed.
     - Visualizations were generated to compare training and validation performance over epochs.

## Results Obtained:
- **Model Architecture**:
   - Successfully defined and saved the ANN model architecture as `ann_architecture.json`.
- **Training Results**:
   - Training results, including accuracy and loss over epochs, were saved in `training_results.csv`.
   - The best model was saved as `best_model.h5`.
- **Predictions**:
   - The model's predictions on the test dataset were saved in `predictions.csv`.
- **Tally Results**:
   - The tally results comparing model predictions with actual outcomes were saved in `tally_results.csv`.
- **Visualization**:
   - Training and validation accuracy/loss curves were plotted to assess model performance over epochs.

## Summary:
In this predictive modeling phase, we successfully defined, trained, and optimized an ANN model to predict customer churn. The model was evaluated using various performance metrics, and the predictions were tallied against actual outcomes for validation. The model and its associated outputs were saved for future use, ensuring that the results are reproducible and can be further analyzed or deployed as needed.

## Next Steps:
1. **Predicting Customer Churn Based on Critical Attributes (CCA12)**:
   - Use the trained ANN model to predict customer churn.
   - Analyze critical attributes influencing the prediction to gain insights into key factors driving customer churn.

2. **Evaluating Model Performance and Analyzing Predictions (CCA13)**:
   - Evaluate the performance of the ANN model using metrics such as accuracy, precision, recall, and F1-score.
   - Analyze the model's predictions to extract insights into customer churn patterns.

3. **Ongoing Documentation**:
   - Continue documenting all steps and results comprehensively, ensuring transparency and reproducibility in future phases of the project.

